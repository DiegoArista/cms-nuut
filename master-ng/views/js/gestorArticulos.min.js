$("#btnAgregarArticulo").click(function(){$("#agregarArtículo").toggle(400)}),$("#subirFoto").change(function(){if(imagen=this.files[0],imagenSize=imagen.size,imagenSize>2e6?$("#arrastreImagenArticulo").before('<div class= "alert alert-warning alerta text-center"> El archivo excede el peso permitido, 2MB</div> '):$(".alerta").remove(),imagenType=imagen.type,"image/jpeg"==imagenType||"image/png"==imagenType?$(".alerta").remove():$("#arrastreImagenArticulo").before('<div class= "alert alert-warning alerta text-center"> El archivo debe ser formaro JPG o PNG</div> '),Number(imagenSize)<2e6&&"image/jpeg"==imagenType||"image/png"==imagenType){var e=new FormData;e.append("imagen",imagen),$.ajax({url:"views/ajax/gestorArticulos.php",method:"POST",data:e,cache:!1,contentType:!1,processData:!1,beforeSend:function(){$("#arrastreImagenArticulo").before('<img src="views/images/status.gif" id="status">')},success:function(e){$("#status").remove(),0==e?$("#arrastreImagenArticulo").before('<div class= "alert alert-warning alerta text-center">La imagen es inferior a 800px x  400px</div> '):$("#arrastreImagenArticulo").html('<div id="imagenArticulo"><img src="'+e.slice(6)+'" class="img-thumbnail"></div> ')}})}}),$(".editarArticulo").click(function(){idArticulo=$(this).parent().parent().attr("id"),rutaImagen=$("#"+idArticulo).children("img").attr("src"),titulo=$("#"+idArticulo).children("h1").html(),introduccion=$("#"+idArticulo).children("p").html(),contenido=$("#"+idArticulo).children("input").val(),$("#"+idArticulo).html('<form method="post" enctype="multipart/form-data"><span><input type="submit" style="width:10%; padding:5px 0; margin-top:4px; " class="btn btn-primary pull-right" value="Guardar"></span><div id="editarImagen"><input type="file" style="display:none"  id="subirNuevaFoto" class="btn btn-default" ><div id="nuevaFoto"><span  class="fa fa-times cambiarImagen"></span><img src="'+rutaImagen+'" class="img-thumbnail"></div></div><input type="text" value="'+titulo+'" name="editarTitulo"><textarea cols="30" rows="5" name="editarIntroduccion">'+introduccion+'</textarea><textarea name="editarContenido" id="editarContenido" cols="30" rows="10">'+contenido+'</textarea><input type="hidden" value="'+rutaImagen+'" name="fotoAntigua"><input type="hidden" value="'+idArticulo+'" name="id"><hr></form>'),$(".cambiarImagen").click(function(){$(this).hide(),$("#subirNuevaFoto").show(),$("#subirNuevaFoto").css({width:"90%"}),$("#nuevaFoto").html(""),$("#subirNuevaFoto").attr("name","editarImagen"),$("#subirNuevaFoto").attr("required",!0),console.log(rutaImagen),$("#subirNuevaFoto").change(function(){if(imagen=this.files[0],imagenSize=imagen.size,imagenSize>2e6?$("#editarImagen").before('<div class= "alert alert-warning alerta text-center"> El archivo excede el peso permitido, 2MB</div> '):$(".alerta").remove(),imagenType=imagen.type,"image/jpeg"==imagenType||"image/png"==imagenType?$(".alerta").remove():$("#editarImagen").before('<div class= "alert alert-warning alerta text-center"> El archivo debe ser formaro JPG o PNG</div> '),Number(imagenSize)<2e6&&"image/jpeg"==imagenType||"image/png"==imagenType){var e=new FormData;e.append("imagen",imagen),$.ajax({url:"views/ajax/gestorArticulos.php",method:"POST",data:e,cache:!1,contentType:!1,processData:!1,beforeSend:function(){$("#nuevaFoto").before('<img src="views/images/status.gif" style="width:15%; margin-left:65px;" id="status2">')},success:function(e){$("#status2").remove(),0==e?$("#editarImagen").before('<div class= "alert alert-warning alerta text-center">La imagen es inferior a 800px x  400px</div> '):$("#nuevaFoto").html('<div id="imagenArticulo"><img src="'+e.slice(6)+'" class="img-thumbnail"></div> ')}})}})})});var almacenarOrdenId=new Array,ordenItem=new Array;$("#ordenarArticulos").click(function(){$("#ordenarArticulos").hide(),$("#guardarOrdenArticulos").show(),$("#editarArticulo").css({cursor:"move"}),$("#editarArticulo span i").hide(),$("#editarArticulo button").hide(),$("#editarArticulo img").hide(),$("#editarArticulo p").hide(),$("#editarArticulo hr").hide(),$("#editarArticulo div").remove(),$(".bloqueArticulo h1").css({"font-size":"14px",position:"absolute",padding:"10px",top:"-15px"}),$(".bloqueArticulo").css({padding:"2px"}),$("#editarArticulo span").html('<i class="glyphicon glyphicon-move" style="padding:8px"></i>'),$("body, html").animate({scrollTop:$("body").offset().top},500),$("#editarArticulo").sortable({revert:!0,connectWith:".bloqueArticulo",handle:".handleArticle",stop:function(e){for(var a=0;a<$("#editarArticulo li").length;a++)almacenarOrdenId[a]=e.target.children[a].id,ordenItem[a]=a+1}}),$("#guardarOrdenArticulos").click(function(){$("#ordenarArticulos").show(),$("#guardarOrdenArticulos").hide();for(var e=0;e<$("#editarArticulo li").length;e++){var a=new FormData;a.append("actualizarOrdenArticulos",almacenarOrdenId[e]),a.append("actualizarOrdenItem",ordenItem[e]),$.ajax({url:"views/ajax/gestorArticulos.php",method:"POST",data:a,cache:!1,contentType:!1,processData:!1,success:function(e){$("#editarArticulo").html(e),swal({title:"¡OK!",text:"¡El orden se ha actualizado correctamente!",type:"success",confirmButtonText:"Cerrar",closeOnConfirm:!1},function(e){e&&(window.location="articulos")})}})}})});