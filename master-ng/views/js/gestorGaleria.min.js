0==$("#lightbox").html()?$("#lightbox").css({height:"100px"}):$("#lightbox").css({height:"auto"}),$("body").on("dragover",function(e){e.preventDefault(),e.stopPropagation()}),$("#lightbox").on("dragover",function(e){e.preventDefault(),e.stopPropagation(),$("#lightbox").css({background:"url(views/images/pattern.jpg)"})}),$("body").on("drop",function(e){e.preventDefault(),e.stopPropagation()});var imagenSize=[],imagenType=[];$("#lightbox").on("drop",function(e){e.preventDefault(),e.stopPropagation(),$("#lightbox").css({background:"white"}),archivo=e.originalEvent.dataTransfer.files;for(var a=0;a<archivo.length;a++)if(imagen=archivo[a],imagenSize.push(imagen.size),imagenType.push(imagen.type),Number(imagenSize[a]>2e6)?$("#lightbox").before('<div class= "alert alert-warning alerta text-center"> El archivo excede el peso permitido, 2MB</div> '):$(".alerta").remove(),"image/jpeg"==imagenType[a]||"image/png"==imagenType[a]?$(".alerta").remove():$("#lightbox").before('<div class= "alert alert-warning alerta text-center"> El archivo debe ser formaro JPG o PNG</div> '),Number(imagenSize[a])<2e6&&"image/jpeg"==imagenType[a]||"image/png"==imagenType[a]){var t=new FormData;t.append("imagen",imagen),$.ajax({url:"views/ajax/gestorGaleria.php",method:"POST",data:t,cache:!1,contentType:!1,processData:!1,beforeSend:function(){$("#lightbox").append('<li id="status"> <img src="views/images/status.gif" style="width:15%; margin-left:65px;" ></li>')},success:function(e){$("#status").remove(),0==e?$("#lightbox").before('<div class= "alert alert-warning alerta text-center">La imagen es inferior a 1024px x  768px</div> '):($("#lightbox").css({height:"auto"}),$("#lightbox").append('<li> <span class="fa fa-times"></span><a rel="grupo" href="'+e.slice(6)+'"><img src="'+e.slice(6)+'"></a></li> '),swal({title:"¡OK!",text:"¡La imagen se subió correctamente!",type:"success",confirmButtonText:"Cerrar",closeOnConfirm:!1},function(e){e&&(window.location="galeria")}))}})}}),$(".eliminarFoto").click(function(){1==$(".eliminarFoto").length&&$("#lightbox").css({height:"100px"}),idGaleria=$(this).parent().attr("id"),rutaGaleria=$(this).attr("ruta"),$(this).parent().remove();var e=new FormData;e.append("idGaleria",idGaleria),e.append("rutaGaleria",rutaGaleria),$.ajax({url:"views/ajax/gestorGaleria.php",method:"POST",data:e,cache:!1,contentType:!1,processData:!1,success:function(e){}})});var almacenarOrdenId=[],ordenItem=[];$("#ordenarGaleria").click(function(){$("#ordenarGaleria").hide(),$("#guardarGaleria").show(),$("#lightbox").css({cursor:"move"}),$("#lightbox span").hide(),$("#lightbox").sortable({revert:!0,connectWith:".bloqueGaleria",handle:".handleImg",stop:function(e,a){for(var t=0;t<$("#lightbox li").length;t++)almacenarOrdenId[t]=e.target.children[t].id,ordenItem[t]=t+1}})}),$("#guardarGaleria").click(function(){$("#ordenarGaleria").show(),$("#guardarGaleria").hide();for(var e=0;e<$("#lightbox li").length;e++){var a=new FormData;a.append("actualizarOrdenGaleria",almacenarOrdenId[e]),a.append("actualizarOrdenItem",ordenItem[e]),$.ajax({url:"views/ajax/gestorGaleria.php",method:"POST",data:a,cache:!1,contentType:!1,processData:!1,success:function(e){$("#lightbox").html(e),swal({title:"¡OK!",text:"¡El orden se ha actualizado correctamente!",type:"success",confirmButtonText:"Cerrar",closeOnConfirm:!1},function(e){e&&(window.location="galeria")})}})}});