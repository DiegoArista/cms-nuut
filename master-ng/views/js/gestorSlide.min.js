0==$("#columnasSlide").html()?$("#columnasSlide").css({height:"100px"}):$("#columnasSlide").css({height:"auto"}),$("#columnasSlide").on("dragover",function(e){e.preventDefault(),e.stopPropagation(),$("#columnasSlide").css({background:"url('views/images/pattern.jpg')",transition:"all .5s ease-in"})}),$("#columnasSlide").on("drop",function(e){e.preventDefault(),e.stopPropagation(),$("#columnasSlide").css({background:"white"});var a=e.originalEvent.dataTransfer.files,i=a[0],t=i.size;Number(t)>2e6?$("#columnasSlide").before('<div class="alert alert-warning text-center">El archivo excede el peso permitido 2 MB</div>'):$(".alert").remove();var r=i.type;if("image/jpeg"==r||"image/png"==r?$(".alert").remove():$("#columnasSlide").before('<div class="alert alert-warning text-center">El archivo debe ser formato jpg o png.</div>'),Number(t)<2e6&&"image/jpeg"==r||"image/png"==r){var n=new FormData;n.append("imagen",i),$.ajax({url:"views/ajax/GestorSlide.php",method:"POST",data:n,cache:!1,contentType:!1,processData:!1,dataType:"json",beforeSend:function(){$("#columnasSlide").before('<img src="views/images/status.gif" id="status">')},success:function(e){$("#status").remove(),0==e?$("#columnasSlide").before('<div class="alert alert-warning text-center">El imagen es inferior a 1600px x 600px.</div>'):($("#columnasSlide").css({height:"auto"}),$("#columnasSlide").append('<li class="bloqueSlide"><span class="fa fa-times"></span><img src="'+e.ruta.slice(6)+'" class="handleImg"></li>'),$("#ordenarTextSlide").append('<li><span class="fa fa-pencil" style="background:blue"></span><img src="'+e.ruta.slice(6)+'"style="float:left; margin-bottom:10px" width="80%"><h1>'+e.titulo+"</h1> <p>"+e.descripcion+"</p></li>"),swal({title:"¡OK!",text:"¡La imagen se subió correctamente!",type:"success",confirmButtonText:"Cerrar",closeOnConfirm:!1},function(e){e&&(window.location="slide")}))}})}}),$(".eliminarSlide").click(function(){1==$(".eliminarSlide").length&&$("#columnasSlide").css({height:"100px"}),idSlide=$(this).parent().attr("id"),rutaSlide=$(this).attr("ruta"),$(this).parent().remove(),$("#item"+idSlide).remove();var e=new FormData;e.append("idSlide",idSlide),e.append("rutaSlide",rutaSlide),$.ajax({url:"views/ajax/GestorSlide.php",method:"POST",data:e,cache:!1,contentType:!1,processData:!1,success:function(e){}})}),$(".editarSlide").click(function(){idSlide=$(this).parent().attr("id"),rutaImagen=$(this).parent().children("img").attr("src"),rutaTitulo=$(this).parent().children("h1").html(),rutaDescripcion=$(this).parent().children("p").html(),$(this).parent().html('<img src="'+rutaImagen+'" class="img-thumbnail"><input type="text" class="form-control" id="enviarTitulo" placeholder="Título" value="'+rutaTitulo+'"><textarea row="5" id="enviarDescripcion" class="form-control" placeholder="Descripción" >'+rutaDescripcion+'</textarea><button class="btn btn-info pull-right" id="guardar'+idSlide+'" style="margin:10px">Guardar</button>'),$("#guardar"+idSlide).click(function(){enviarId=idSlide.slice(4),enviarTitulo=$("#enviarTitulo").val(),enviarDescripcion=$("#enviarDescripcion").val();var e=new FormData;e.append("enviarId",enviarId),e.append("enviarTitulo",enviarTitulo),e.append("enviarDescripcion",enviarDescripcion),$.ajax({url:"views/ajax/GestorSlide.php",method:"POST",data:e,cache:!1,contentType:!1,processData:!1,dataType:"json",success:function(e){$("#guardar"+idSlide).parent().html('<span class="fa fa-pencil editarSlide" style="background:blue"></span><img src="'+rutaImagen+'"style="float:left; margin-bottom:10px" width="80%"><h1>'+e.titulo+"</h1> <p>"+e.descripcion+"</p>"),swal({title:"¡OK!",text:"¡Se han guardado los cambios correctamente!",type:"success",confirmButtonText:"Cerrar",closeOnConfirm:!1},function(e){e&&(window.location="slide")})}})})});var almacenarOrdenId=new Array,ordenItem=new Array;$("#ordenarSlide").click(function(){$("#columnasSlide").css({cursor:"move"}),$("#columnasSlide span").hide(),$("#columnasSlide").sortable({revert:!0,connectWith:".bloqueSlide",handle:".handleImg",stop:function(e,a){for(var i=0;i<$("#columnasSlide li").length;i++)almacenarOrdenId[i]=e.target.children[i].id,ordenItem[i]=i+1}}),$("#ordenarSlide").hide(),$("#guardarSlide").show()}),$("#guardarSlide").click(function(){$("#ordenarSlide").show(),$("#guardarSlide").hide();for(var e=0;e<$("#columnasSlide li").length;e++){var a=new FormData;a.append("actualizarOrdenSlide",almacenarOrdenId[e]),a.append("actualizarOrdenItem",ordenItem[e]),$.ajax({url:"views/ajax/GestorSlide.php",method:"POST",data:a,cache:!1,contentType:!1,processData:!1,success:function(e){$("#textoSlide ul").html(e),swal({title:"¡OK!",text:"¡El orden se ha actualizado correctamente!",type:"success",confirmButtonText:"Cerrar",closeOnConfirm:!1},function(e){e&&(window.location="slide")})}})}});